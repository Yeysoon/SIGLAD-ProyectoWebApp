<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AGENTE - Validación de DUCA (CU-04)</title>
    <link rel="icon" href="/favicon.ico">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="./css/usuarios.css" rel="stylesheet">
    <link href="./css/statusDuca.css" rel="stylesheet">
</head>
<body>

<!-- SIDEBAR -->
<aside class="sidebar">
    <div class="sidebar-header">
        <div class="sidebar-logo">SIGLAD</div>
        <div class="sidebar-subtitle">Agente Aduanero</div>
    </div>
    <ul class="sidebar-menu">
        <li><a href="dashboardAgente.html"><i class="fas fa-th-large"></i><span>Dashboard</span></a></li>
        <li><a href="agente.html" class="active"><i class="fas fa-clipboard-check"></i><span>Validar DUCAs</span></a></li>
        <li><a href="statusAgente.html"><i class="fas fa-chart-line"></i><span>Estado de DUCAs</span></a></li>
        <li><hr></li>
        <li><a href="#" id="btnLogout"><i class="fas fa-sign-out-alt"></i><span>Cerrar sesión</span></a></li>
    </ul>
</aside>

<!-- HEADER -->
<header class="header">
    <div class="header-title">Validación de DUCA´s</div>
    <div class="header-actions">
        <div class="user-info">
            <div class="user-avatar">A</div>
            <span id="roleInfo">Agente Aduanero</span>
        </div>
    </div>
</header>

<!-- MAIN CONTENT -->
<main class="main-content">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <p id="roleInfo" class="text-muted mb-0"></p>
    </div>
    <p id="status" class="text-muted"></p>
    <div id="valErrors"></div>

    <!-- Tabla -->
    <div class="table-section">
        <h3>📋 DUCAs pendientes de validación</h3>
        <table class="table table-striped table-sm mb-0">
            <thead>
                <tr>
                    <th>Documento</th>
                    <th>Emisión</th>
                    <th>Exportador</th>
                    <th>Importador</th>
                    <th>Valor Total</th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody id="pendingTableBody">
                <tr><td colspan="6" class="text-center">Cargando lista...</td></tr>
            </tbody>
        </table>
    </div>

    <!-- Debug -->
    <div class="mt-4">
        <h5>Respuesta del servidor (Debug)</h5>
        <pre id="serverOut" class="json-viewer">{}</pre>
    </div>
</main>

<!-- MODAL BOOTSTRAP 5 -->
<div class="modal fade" id="validationModal" tabindex="-1" aria-labelledby="modalTitle" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modalTitle">Procesar DUCA: <span id="ducaToProcess"></span></h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>Estado Final Propuesto: <strong id="finalState"></strong></p>
                <div class="mb-3">
                    <label for="validationNotes" class="form-label">Comentarios/Justificación:</label>
                    <textarea class="form-control" id="validationNotes" rows="3" placeholder="Indique la razón de la VALIDACIÓN o RECHAZO..."></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-primary" id="btnConfirmValidation">Confirmar Acción</button>
            </div>
        </div>
    </div>
</div>

<!-- Scripts originales sin cambios -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="js/agente.js"></script>
</body>
</html>